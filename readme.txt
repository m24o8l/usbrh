USBRH on Linux ver.0.07 Readme
2019/07/07

 1. これはなに？
    Strawberry Linux Co., Ltd.から販売されている USB接続型温湿度計 USBRH を、
    Linuxで使うためのアプリケーション・プログラムです。
    このバージョンより複数接続に対応しました。

 2. 必要なもの
    このプログラムを使うには、以下のものが必要です。

      ・USBRH
      ・USB(特にHID)が使えるように設定されたLinux
      ・gcc
      ・libusb

    Debianなどパッケージ管理システムを採用しているLinuxでは、libudbはlibusb-devなどの
    開発用のものを用意してください。

    最近のデストリビューションでは標準でカーネルはUSB対応となっている様ですので、管理者が
    いじる必要はないかと思われますが、もし未対応であれば適宜文献等参照の上設定を変更、
    コンパイルしてください。

    なお、カーネルの設定を変更する事は、相当のリスクを伴います。充分注意してください。

 3. コンパイルとインストール/アンインストール
    ただし make install は実装していませんので、インストールに際して実行ファイルは
    手動にて適当なディレクトリへコピーしてください。
    アンインストールは、実行ファイルを削除するのみです。

    コンパイル実行例：
      $ sudo make

 4. 使い方
    非常に単純です。

      usbrh [-vthm1flLH]

         (オプション無し) 温度と湿度を単位無しで表示します。これは USBRH on *BSD と
                          同一となります。
          -v: verbose     冗長表示 表示は USBRH on *BSD と同一となります。
          -t: temperature MRTG2で使うことを意図した表示で、MRTG2へ取り込むのに適した
                          数値を表示します。
          -h: humidity    MRTG2で使うことを意図した表示で、MRTG2へ取り込むのに適した
                          数値を表示します。
          -m: MRTG output MRTG2で使うことを意図した表示で、上記の二つを合わせた表示です。
                          使うことはないでしょうが、温度と湿度を一つのグラフにまとめたい
                          というときにどうぞ。
          -1: 1-line      verbose の表示を一行で出力します。リダイレクトしてwebcamや
                          camEなどのinfoファイルとして取り込む事を意図しています。
          -s: no LED      計測中、ヒーター中のLED点灯を抑止します。
          -fn: set device データを取り込むUSBRHを指定します。nは0以上、つまり1からはじまり
                          最大値は「システムに接続されたUSBRHの個数」までとなります。
                          指定がない場合、「最初に発見したUSBRH」から読み込みます。
          -l: list        USBのどこにUSBRHが接続されているかを表示します。
                          単純にlibusbで検索した結果を表示しているだけですので、必ずしも
                          発見順が-fオプションと同じになるとは限りません。
                          また、ハードウェア環境に左右されますので、 bus=1 device=1 から
                          始まるとは限りません。
          -Hn: set heater ヒーターの制御を行います。
　　　　　　　　　　　　　nには0から60を指定します。数字で指定した秒数ヒーターをオンにします。0の場合はヒーターのオン動作はせず、オフにする操作だけします。またヒーターがオンの状態の間、赤LEDを点灯させます。
                          このオプションを設定すると、温湿度の表示を行いません。
          -L:  set LED    LED点灯のテストを行います。
                          このオプションを設定すると、温湿度の表示を行いません。

     実行例：
         $ ./usbrh
         20.19 40.63

         $ ./usbrh -v
         Temperature: 20.08 C
         Humidity: 41.01 %

         $ ./usbrh -L
         $ ./usbrh -H10

    もしも USBRH を発見できなかった場合、「USBRH not found」を表示して終了します。

 5. 注意
    ・プログラムは未保障です。その作成、実行に際して何らかの損害が発生したとしても、
      作者は一切関知しません。
    ・USB未対応カーネルをUSB対応へと設定変更する際、必ず変更者の責任の元において
      作業してください。それらの作業によって発生した損害は、作者は一切関知しません。
    ・クリティカルな測定には使用しないで下さい。ハードもソフトもそのような使い方に
      向いていません。
    ・その他、USBRHの説明書にある注意事項は、必ず守ってください。

    ・プログラムの改変、内容の他プログラムへの適用はご自由に行って頂いても構いませんが、
      その結果は保証しませんし、関知しません。変更者に帰属するものとします。
    ・再配布する場合は、ダウンロードしたときの「そのままの形」で再配布下さい。

 6. 開発環境
    ハードウェア：
        ・HP ProLiant MicroServer
        ・USBRH
    ソフトウェア：
      ・HP ProLiant MicroServer
        ・Linux 3.16.0-44-generic #59-Ubuntu SMP Tue Jul 7 02:07:39 UTC 2015 x86_64 x86_64 x86_64 GNU/Linux
        ・gcc (Ubuntu 4.9.1-16ubuntu6) 4.9.1
        ・GNU Make4.0
        ・libusb-1.0-0 / libusb-1.0-0-dev

 7. 謝辞
    あおやまさん作の USBRH on *BSD が無ければ、多分こんなプログラムを作ろうなんて
    気にはならなかったと思います。
    また、その解析事例は大変参考になりました。この場を借りて御礼申し上げます。

 8. リンク
    USBRH on *BSD: http://www.nk-home.net/~aoyama/usbrh/
    libusb: http://libusb.sourceforge.net/
    Strawberry Linux co.ltd. http://strawberry-linux.com/

 9. 更新履歴
    0.03 2007-04-10 エラー処理の強化とデータの読み込みを修正
    0.04 2007-04-20 複数接続に対応
    0.05 2008-03-24 string.hをincludeしていないと、コンパイル環境によっては
                    コンパイルした時に警告を吐くので対処
    0.06 2016-09-10 LEDとヒーターの制御機能を追加
                    いくつかのバグを修正
    0.07 2019-07-05 ヒーター操作を秒数指定に変更
                    ヒータ中は赤LEDを点灯させる
                    計測中に緑LEDを点灯
    0.08 2019-07-07 湿度計測のバグ修正 https://github.com/tadokoro/usbrh-hidapi　を拝見しました。
　　　　　　　　　　　自分の環境ではエラーにならんのですが、そのうち見てみます。
